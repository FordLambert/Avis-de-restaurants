'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/******/(function (modules) {
	// webpackBootstrap
	/******/ // The module cache
	/******/var installedModules = {};
	/******/
	/******/ // The require function
	/******/function __webpack_require__(moduleId) {
		/******/
		/******/ // Check if module is in cache
		/******/if (installedModules[moduleId]) {
			/******/return installedModules[moduleId].exports;
			/******/
		}
		/******/ // Create a new module (and put it into the cache)
		/******/var module = installedModules[moduleId] = {
			/******/i: moduleId,
			/******/l: false,
			/******/exports: {}
			/******/ };
		/******/
		/******/ // Execute the module function
		/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
		/******/
		/******/ // Flag the module as loaded
		/******/module.l = true;
		/******/
		/******/ // Return the exports of the module
		/******/return module.exports;
		/******/
	}
	/******/
	/******/
	/******/ // expose the modules object (__webpack_modules__)
	/******/__webpack_require__.m = modules;
	/******/
	/******/ // expose the module cache
	/******/__webpack_require__.c = installedModules;
	/******/
	/******/ // define getter function for harmony exports
	/******/__webpack_require__.d = function (exports, name, getter) {
		/******/if (!__webpack_require__.o(exports, name)) {
			/******/Object.defineProperty(exports, name, {
				/******/configurable: false,
				/******/enumerable: true,
				/******/get: getter
				/******/ });
			/******/
		}
		/******/
	};
	/******/
	/******/ // getDefaultExport function for compatibility with non-harmony modules
	/******/__webpack_require__.n = function (module) {
		/******/var getter = module && module.__esModule ?
		/******/function getDefault() {
			return module['default'];
		} :
		/******/function getModuleExports() {
			return module;
		};
		/******/__webpack_require__.d(getter, 'a', getter);
		/******/return getter;
		/******/
	};
	/******/
	/******/ // Object.prototype.hasOwnProperty.call
	/******/__webpack_require__.o = function (object, property) {
		return Object.prototype.hasOwnProperty.call(object, property);
	};
	/******/
	/******/ // __webpack_public_path__
	/******/__webpack_require__.p = "";
	/******/
	/******/ // Load entry module and return exports
	/******/return __webpack_require__(__webpack_require__.s = 0);
	/******/
})(
/************************************************************************/
/******/[
/* 0 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";

	Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
	/* harmony import */var __WEBPACK_IMPORTED_MODULE_0__conductor__ = __webpack_require__(1);

	var conductor = new __WEBPACK_IMPORTED_MODULE_0__conductor__["a" /* Conductor */]();
	conductor.initialiseData();

	/***/
},
/* 1 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";
	/* harmony import */
	var __WEBPACK_IMPORTED_MODULE_0__models_restaurant_store__ = __webpack_require__(2);
	/* harmony import */var __WEBPACK_IMPORTED_MODULE_1__models_restaurant__ = __webpack_require__(3);
	/* harmony import */var __WEBPACK_IMPORTED_MODULE_2__managers_visual_display_manager__ = __webpack_require__(4);
	/* harmony import */var __WEBPACK_IMPORTED_MODULE_3__managers_JSON_manager__ = __webpack_require__(5);

	var Conductor = function () {
		function Conductor() {
			_classCallCheck(this, Conductor);

			this.restaurantStore = new __WEBPACK_IMPORTED_MODULE_0__models_restaurant_store__["a" /* RestaurantStore */]();

			this.visualDisplayManager = new __WEBPACK_IMPORTED_MODULE_2__managers_visual_display_manager__["a" /* VisualDisplayManager */]();
			this.jsonManager = new __WEBPACK_IMPORTED_MODULE_3__managers_JSON_manager__["a" /* JsonManager */]();
		}

		_createClass(Conductor, [{
			key: 'initialiseData',
			value: function initialiseData() {

				this.handleJsonUploads();
				this.jsonManager.importJson('restaurant_list');
				setTimeout(function () {
					this.followingInstructions();
				}.bind(this), 1000);
			}
		}, {
			key: 'handleJsonUploads',
			value: function handleJsonUploads() {

				var prototypeToUse = __WEBPACK_IMPORTED_MODULE_1__models_restaurant__["a" /* Restaurant */];
				var storeToUse = this.restaurantStore;

				document.addEventListener('upload-complete', function (event, newFile) {
					this.jsonManager.convertAndStoreJson(newFile, prototypeToUse, storeToUse);
				}.bind(this));
			}
		}, {
			key: 'followingInstructions',
			value: function followingInstructions() {
				this.visualDisplayManager.displayListInPage(this.restaurantStore.restaurantList);
			}
		}]);

		return Conductor;
	}();
	/* harmony export (immutable) */

	__webpack_exports__["a"] = Conductor;
	;

	/***/
},
/* 2 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";

	var RestaurantStore = function () {
		function RestaurantStore() {
			_classCallCheck(this, RestaurantStore);

			this.restaurantList = [];
		}

		_createClass(RestaurantStore, [{
			key: 'getList',
			value: function getList() {
				return this.restaurantList;
			}
		}, {
			key: 'add',
			value: function add(restaurant) {
				this.restaurantList.push(restaurant);
			}
		}, {
			key: 'getRestaurant',
			value: function getRestaurant(index) {
				return this.restaurantList[index];
			}
		}]);

		return RestaurantStore;
	}();
	/* harmony export (immutable) */

	__webpack_exports__["a"] = RestaurantStore;
	;

	/***/
},
/* 3 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";

	var Restaurant = function () {
		function Restaurant(array) {
			_classCallCheck(this, Restaurant);

			this.name = array[0];
			this.adress = array[1];
			this.latitude = array[2];
			this.longitude = array[3];
			this.ratings = array[4];
		}

		_createClass(Restaurant, [{
			key: 'addRatingToList',
			value: function addRatingToList(rating) {
				this.ratings.push(rating);
			}
		}]);

		return Restaurant;
	}();
	/* harmony export (immutable) */

	__webpack_exports__["a"] = Restaurant;
	;

	/***/
},
/* 4 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";

	var VisualDisplayManager = function () {
		function VisualDisplayManager() {
			_classCallCheck(this, VisualDisplayManager);

			this._selectors = {
				'restaurantList': 'restaurant-list'
			};
			this.restaurantDomList = document.getElementById(this._selectors.restaurantList);
		}

		_createClass(VisualDisplayManager, [{
			key: 'displayListInPage',
			value: function displayListInPage(restaurantList) {

				restaurantList.map(function (restaurant) {
					this.restaurantDomList.prepend('<div class="restaurant"><h2>"' + restaurant.name + '"</h2><p>' + this.getStarAverage(restaurant) + '<p></div>');
				}.bind(this));
			}

			//will probably not stay here

		}, {
			key: 'getStarAverage',
			value: function getStarAverage(restaurant) {
				var totalStarNote = 0;

				restaurant.ratings.map(function (currentRating) {

					totalStarNote = totalStarNote + currentRating.stars;
				});

				return totalStarNote / restaurant.ratings.length;
			}
		}]);

		return VisualDisplayManager;
	}();
	/* harmony export (immutable) */

	__webpack_exports__["a"] = VisualDisplayManager;
	;

	/***/
},
/* 5 */
/***/function (module, __webpack_exports__, __webpack_require__) {

	"use strict";

	var JsonManager = function () {
		function JsonManager() {
			_classCallCheck(this, JsonManager);
		}

		_createClass(JsonManager, [{
			key: 'importJson',
			value: function importJson(fileName) {
				var self = this;
				var path = 'app/data/' + fileName + '.json';

				/*
    $.ajax({
     	type: 'GET',
     	url: path,
    		 	success: function(result) {
     		$(document).trigger('upload-complete', [result]);
    		},
    	 		error : function(XMLHttpRequest, textStatus, errorThrown){
    			console.log('JSON import Error : ' + XMLHttpRequest.status);
          }
    	});
    	*/

				var req = new XMLHttpRequest();
				req.open("GET", path);
				// Gestion de l'événement indiquant la fin de la requête
				req.addEventListener("load", function () {
					// Affiche la réponse reçue pour la requête
					console.log(req.responseText);
				});
				req.send(null);
			}
		}, {
			key: 'convertAndStoreJson',
			value: function convertAndStoreJson(jsonFile, prototype, objectStore) {
				jsonFile.map(function (jsonObject) {
					var attributeList = [];

					for (var attribute in jsonObject) {
						attributeList.push(jsonObject[attribute]);
					}

					var newObject = new prototype.init(attributeList); //correction need to be made here
					objectStore.add(newObject);
				});
			}
		}]);

		return JsonManager;
	}();
	/* harmony export (immutable) */

	__webpack_exports__["a"] = JsonManager;
	;

	/***/
}]
/******/);